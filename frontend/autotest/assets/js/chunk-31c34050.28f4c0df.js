(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-31c34050"],{"1d10":function(t,e,s){"use strict";s("223d")},"223d":function(t,e,s){},"226a":function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("el-card",{staticClass:"tools-card",attrs:{shadow:"always","body-style":{padding:"3px 0"}}},[s("el-row",[s("el-col",{attrs:{span:2}},[s("el-tooltip",{attrs:{effect:"dark",content:"新增步骤",placement:"top-end"}},[s("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.addItemList}},[s("i",{staticClass:"el-icon-document-add"}),t._v(" 新增 ")])],1)],1),s("el-col",{attrs:{span:2}},[s("el-tooltip",{attrs:{effect:"dark",content:"生成所有内容的结果",placement:"top-end"}},[s("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.notifyComponentTransmit}},[s("i",{staticClass:"el-icon-thumb"}),t._v(" 确定 ")])],1)],1),s("el-col",{attrs:{span:2}},[s("el-tooltip",{attrs:{effect:"dark",content:"清空所有内容",placement:"top-start"}},[s("el-button",{attrs:{type:"danger",size:"small"},on:{click:t.reset}},[s("i",{staticClass:"el-icon-delete"}),t._v(" 清空 ")])],1)],1)],1)],1),s("el-main",{staticStyle:{padding:"0 5px"}},[s("el-tabs",{attrs:{type:"border-card"},model:{value:t.editableTabsValue,callback:function(e){t.editableTabsValue=e},expression:"editableTabsValue"}},t._l(t.itemList,(function(e,a){return s("el-tab-pane",{key:e.index,attrs:{label:e.title,name:e.name}},[s("db-edit-item",{key:e.index,attrs:{"step-index":e.index,"submit-flag":t.submitFlag,"parent-reset-state":t.resetState},on:{receiveData:t.handleData}})],1)})),1)],1),s("result-dialog",{attrs:{"text-content":t.resultTextarea,"from-dialog-visible":t.dialogVisible},on:{changeDialogVisible:t.changeDialogVisible}})],1)},i=[],l=(s("d81d"),s("b64b"),s("fb6a"),function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("el-form",{ref:"form",staticStyle:{width:"100%"},attrs:{model:t.form,"label-width":"1px"}},[s("el-row",{staticClass:"form-el-row"},[s("el-col",{attrs:{span:2}},[s("el-tooltip",{attrs:{effect:"dark",content:"请输入在基础配置中配置的数据库名",placement:"top-end"}},[s("div",{staticClass:"form-item-title"},[s("span",[t._v("数据库db：")])])])],1),s("el-col",{attrs:{span:2}},[s("el-form-item",{attrs:{label:""}},[s("el-input",{attrs:{placeholder:"数据库名"},model:{value:t.form.dbName,callback:function(e){t.$set(t.form,"dbName",e)},expression:"form.dbName"}})],1)],1),s("el-col",{attrs:{span:2}},[s("el-tooltip",{attrs:{effect:"dark",content:"验证类型",placement:"top-start"}},[s("div",{staticClass:"form-item-title"},[s("span",[t._v("验证类型")]),s("el-popover",{attrs:{placement:"top-start",trigger:"click",title:"说明：",content:'"=": 相等; "!=": 不相等;"~": 包含; "!~": 不包含'}},[s("i",{staticClass:"el-icon-chat-dot-square",attrs:{slot:"reference"},slot:"reference"})])],1)])],1),s("el-col",{attrs:{span:2}},[s("el-form-item",{attrs:{label:""}},[s("el-select",{attrs:{placeholder:"请选择验证类型"},model:{value:t.form.vfTypeValue,callback:function(e){t.$set(t.form,"vfTypeValue",e)},expression:"form.vfTypeValue"}},t._l(t.form.vfTypeOptions,(function(t){return s("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1)],1),s("el-col",{attrs:{span:2}},[s("div",{staticClass:"form-item-title"},[s("span",[t._v("SQL语句：")])])]),s("el-col",{attrs:{span:14}},[s("el-form-item",{attrs:{label:""}},[s("el-input",{attrs:{placeholder:"请输入SQL语句"},model:{value:t.form.sql,callback:function(e){t.$set(t.form,"sql",e)},expression:"form.sql"}})],1)],1)],1),s("el-row",[s("el-col",{attrs:{span:2}},[s("div",{staticClass:"form-item-title"},[s("span",[t._v("验证内容：")])])]),s("el-col",{attrs:{span:22}},[s("el-tabs",{attrs:{type:"border-card"},on:{"tab-click":t.handleTabClick},model:{value:t.formTabsName,callback:function(e){t.formTabsName=e},expression:"formTabsName"}},[s("el-tab-pane",{ref:"tablePage",attrs:{label:"验证内容",name:"vfContent"}},[s("table-item",{attrs:{"item-height":t.tableHeight,"is-active":t.tabActive.vfContent,"is-submit":t.isPreview,"reset-flag":t.resetState},on:{receiveTableData:t.handleTableData}})],1)],1)],1)],1)],1),s("el-row",{staticStyle:{"margin-top":"10px"}},[s("el-col",{attrs:{span:2}},[s("el-tooltip",{attrs:{effect:"dark",content:"预览当前的内容",placement:"top-end"}},[s("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.preview}},[s("i",{staticClass:"el-icon-document"}),t._v(" 预览")])],1)],1),s("el-col",{attrs:{span:2}},[s("el-tooltip",{attrs:{effect:"dark",content:"清空当前的内容",placement:"top-start"}},[s("el-button",{attrs:{type:"danger",size:"small"},on:{click:t.reset}},[s("i",{staticClass:"el-icon-delete"}),t._v(" 清空")])],1)],1)],1),s("result-dialog",{attrs:{"text-content":t.results.result,"from-dialog-visible":t.results.dialogVisible},on:{changeDialogVisible:t.changeDialogVisible}})],1)}),n=[],o=(s("d3b7"),s("b0c0"),s("faf4")),r=s("a1d3"),c=s("0bee"),u=s("edf3"),m=s("f81d"),d=s("630d"),h=s("d4cf"),b=s("4754"),f=s("bb26"),p=s("fed3"),g=s("175d"),v=s("4824"),y=s("82b1"),C=s("2f14"),T={name:"DbEditItem",components:{ResultDialog:y["a"],TableItem:v["a"],EditableCell:g["a"],ClosePlate:p["a"],OpenPlate:f["a"],SubJsonItem:h["a"],DisplayInput:b["a"],ElColCustom:d["a"],JsonEditByDialog:m["a"],ElRowCustom:u["a"],PartNameText:r["a"],InputItem:o["a"],ContenToolBar:c["a"]},data:function(){return{tableHeight:0,windowHeight:0,formTabsName:"vfContent",tabActive:{vfContent:!1},form:{vfTypeOptions:[{value:"=",label:"相等"},{value:"!=",label:"不相等"},{value:"~",label:"包含"},{value:"!~",label:"不包含"}],dbName:"",vfTypeValue:"=",sql:""},isPreview:!1,resetState:!1,activeNames:["1"],createCompleteSymbol:!1,results:{dbName:"",vfType:"",sql:"",vfContent:"",result:"",dialogVisible:!1,receiveCount:0}}},props:{stepIndex:"",text:"",parentResetState:!1,submitFlag:!1},watch:{parentResetState:{handler:function(){this.handleReset()}},submitFlag:{handler:function(){!0===this.submitFlag&&(console.log("-----------"),this.notifyTransmit())}},createCompleteSymbol:{handler:function(){this.createCompleteSymbol&&!0===this.submitFlag?(this.$emit("receiveData",[this.results.result,this.stepIndex]),console.log("==============")):!0===this.createCompleteSymbol&&(console.log("============"),this.results.dialogVisible=!0),this.createCompleteSymbol=!1}}},mounted:function(){this.windowHeight=document.documentElement.clientHeight,this.fetTableHeight()},methods:{resetHeight:function(){var t=this;return new Promise((function(e,s){t.tableH=0,e()}))},fetTableHeight:function(){var t=this;this.resetHeight().then((function(e){var s=t.$refs.tablePage.$el.getBoundingClientRect(),a=s.top;return t.tableHeight=t.windowHeight-a-100,t.tabActive.vfContent=!0,console.log(t.tableHeight),document.documentElement.clientHeight-a-100}))},getClientHeight:function(){document.documentElement.clientHeight},handleTabClick:function(t,e){this.tabActive[t.name]=!0},handleChange:function(t){console.log(t)},preview:function(){this.notifyTransmit()},notifyTransmit:function(){this.isPreview=!0},resumeSymbol:function(){this.results.receiveCount=0,this.isPreview=!1},changeDialogVisible:function(t){this.results.dialogVisible=t,!1===t&&(this.results.result="")},reset:function(){var t=this,e="是否清空当前步骤的内容";Object(C["a"])(this,(function(){t.handleReset()}),e)},handleReset:function(){var t=this.tableHeight,e=this.windowHeight;Object.assign(this.$data,this.$options.data.call(this)),this.tableHeight=t,this.windowHeight=e,this.fetTableHeight(),this.resetState=Object.assign(this.resetState,!this.resetState)},createResult:function(){if(this.handleStrFields(),this.form.sql&&this.form.dbName){var t='{"sql'+(this.stepIndex+1)+'":{';t+=this.results.sql+",",t+=this.results.dbName+",",t+=this.results.vfType+",",this.results.vfContent?t+=this.results.vfContent:t=t.slice(0,-1),t+="}}",console.log(t),this.results.result=t}else this.results.result="";this.createCompleteSymbol=!0,console.log("set this.createCompleteSymbol")},handleStrFields:function(){this.results.sql='"sql":"'+this.form.sql+'"',this.results.dbName='"db":"'+this.form.dbName+'"',this.results.vfType='"type":"'+this.form.vfTypeValue+'"'},handleTableData:function(t){this.results.vfContent="{}"===t?"":'"check":'+t,this.createResult(),this.resumeSymbol()}}},x=T,w=(s("1d10"),s("2877")),I=Object(w["a"])(x,l,n,!1,null,"6948be12",null),S=I.exports,k=s("f1b2"),V=s("cd63"),D=s("cc84"),H={name:"DbEdit",components:{NarMenuItem:D["a"],NarMenu:V["a"],ContenToolBar:c["a"],TitleText:k["a"],ResultDialog:y["a"],DbEditItem:S},data:function(){return{editableTabsValue:"0",itemList:[{title:"SQL 1",name:"0",index:0}],currentItemIndex:0,submitFlag:!1,dialogVisible:!1,resetState:!1,receivedNum:0,resultTextarea:"",results:{}}},methods:{changeDialogVisible:function(t){this.dialogVisible=t,console.log("============"),console.log(t),!1===t&&(this.resultTextarea="")},addItemList:function(){this.currentItemIndex++,this.editableTabsValue=this.currentItemIndex+"",this.itemList.push({title:"SQL "+(this.currentItemIndex+1),index:this.currentItemIndex,name:this.currentItemIndex+""})},reset:function(){var t=this,e="是否清空所有步骤的内容";Object(C["a"])(this,(function(){Object.assign(t.$data,t.$options.data()),t.resetState=Object.assign(t.resetState,!t.resetState)}),e)},handleData:function(t){this.results[t[1]]=t[0],this.receivedNum++,this.receivedNum===this.itemList.length&&(this.createRes(),this.resumeState())},notifyComponentTransmit:function(){this.submitFlag=!0},convert2json:function(){var t=this,e={},s="{";for(var a in Object.keys(this.results).sort().map((function(s){e[s]=t.results[s]})),e)e[a]&&(s+=e[a].slice(1,-1)+",");"{"===s?s+="}":s=s.slice(0,-1)+"}",this.resultTextarea=s},createRes:function(){this.convert2json(),this.changeDialogVisible(!0)},resumeState:function(){this.receivedNum=0,this.submitFlag=!1},addTab:function(t){this.currentItemIndex++;var e=this.currentItemIndex+"";this.itemList.push({title:"步骤 "+this.currentItemIndex+1,name:e,index:this.currentItemIndex}),this.editableTabsValue=e}}},N=H,_=(s("6966"),Object(w["a"])(N,a,i,!1,null,"1938570c",null));e["default"]=_.exports},"2b74":function(t,e,s){},6966:function(t,e,s){"use strict";s("2b74")}}]);
//# sourceMappingURL=chunk-31c34050.28f4c0df.js.map